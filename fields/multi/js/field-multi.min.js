/**
 * protonThemes Custom Fields JavaScript
 *
 * All JavaScript logic for fields in the post meta box.
 * @since 2.2.3
 *
 */


/*

	$('#animate-clone').cloneya()
        .on('before_clone.cloneya', function (event, toclone) {
            // do something
        })
        .on('after_clone.cloneya', function (event, toclone, newclone) {
            // do something
        })
        .on('before_append.cloneya', function (event, toclone, newclone) {
            $(newclone).css('display', 'none');
            $(toclone).fadeOut('fast', function () {
                $(this).fadeIn('fast');
            });
        })
        .on('after_append.cloneya', function (event, toclone, newclone) {
            $(newclone).slideToggle();
            console.log('finished cloning ' + toclone.attr('id') + ' to ' + newclone.attr('id'));
        })
        .off('remove.cloneya')
        .on('remove.cloneya', function (event, clone) {
            clone.css('background-color', 'red');

            $(clone).slideToggle('slow', function () {
                $(clone).remove();
            });

        })
        .on('after_delete.cloneya', function () {
            console.log('deleted');
        });

 */


(function ($) {

	protonFieldMethods.multi = {
	 	_init: function(element){
			element.find('.proton-multi-field').each(function($field){
				var _this = $(this);
				if(typeof protonFieldMethods[_this.attr('data-field-type')] !== "undefined"){
					protonFieldMethods[_this.attr('data-field-type')]._init(_this);
				}
			});
			var cloneelement = element.find('.proton-multi-wrapper');
			cloneelement.cloneya()
			.on('before_clone.cloneya', function (event, toclone) {
	        	$(toclone).find('.delete .livicon').removeLivicon();
				$(toclone).find('.delete .livicon').remove();
	            $(toclone).find('.delete').prepend('<i class="livicon"></i>');

				toclone.find('.proton-multi-field').each(function($field){
					var _this = $(this);
					if(typeof protonFieldMethods[_this.attr('data-field-type')] !== "undefined"){
						protonFieldMethods[_this.attr('data-field-type')]._destroy(_this);
					}
				});
	        })
	        .on('after_clone.cloneya', function (event, toclone, newclone) {
	        	$(newclone).find('.delete .livicon').removeLivicon();
				$(newclone).find('.delete .livicon').remove();
	            $(newclone).find('.delete').prepend('<i class="livicon"></i>');

				toclone.find('.proton-multi-field').each(function($field){
					var _this = $(this);
					if(typeof protonFieldMethods[_this.attr('data-field-type')] !== "undefined"){
						protonFieldMethods[_this.attr('data-field-type')]._init(_this);
					}
				});

	        })
			.on('after_append.cloneya', function (event, toclone, newclone) {
	            $(toclone).find('.delete .livicon').addLivicon({
				  name : "remove-alt",
				  size : 16,
				  color : "#fff",
				  hovercolor : "#fff",
				  animate : "true",
				  loop : false,
				  eventtype : "hover"
				  });

	            $(newclone).find('.delete .livicon').addLivicon({
				  name : "remove-alt",
				  size : 16,
				  color : "#fff",
				  hovercolor : "#fff",
				  animate : "true",
				  loop : false,
				  eventtype : "hover"
				  });

				newclone.find('.proton-multi-field').each(function($field){
					var _this = $(this);
					if(typeof protonFieldMethods[_this.attr('data-field-type')] !== "undefined"){
						protonFieldMethods[_this.attr('data-field-type')]._init(_this);
					}
				});
	        });
	        element.find('.proton-multi-clone').on('click',function(){
			    cloneelement.triggerHandler('clone.cloneya',[cloneelement.find('.toclone').last()]);
			});
		},
		_destroy: function(element){
			element.find('.proton-multi-wrapper').cloneya('destroy');
		}
 	};

	$(document).ready(function () {
		$( '.proton-field-type-multi' ).each(function() {
			protonFieldMethods.multi._init($(this));
 		});

	});

})(jQuery);