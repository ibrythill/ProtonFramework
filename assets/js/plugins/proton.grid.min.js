/*
 *  Project:
 *  Description:
 *  Author:
 *  License:
 */
!function(O,P,t,e){O.protongrid=function(t,c){var n=this,a={},e={},r={},o,f=0,h=0,i=0,u=0,s=O(t);c=O.extend({selector:".pg-item",columns:4,gutter:20,height:!1,containerHeight:!1,layout:"default",//default, columns
responsive:[[0,480,1],[480,768,3],[768,992,3]],beforeStart:function(){},beforePlaceObject:function(t,n){},afterPlaceObject:function(t,n){},afterEnd:function(){}},c);var p=function(t){if(a[t])return!1;a[t]={};for(var n=0;n<c.columns;n++){var e=n;//* ($_colWidth + options.gutter);
a[t][e]=!1}u=t},g=function(){return(s.width()-c.gutter*(c.columns-1))/c.columns},l=function(){return!1===c.height?f:c.height},d=function(t){i<t&&(i=t)},v=function(t,n,e,r){var o=[];if(t=parseInt(t),n=parseInt(n),e=void 0!==e?parseInt(e):0,(r=void 0!==r?parseInt(r):0)>c.columns&&(r=c.columns),n+r>c.columns)return u<(t+=1)&&p(t),v(t,0,e,r);
//find columns
for(var i=t;i<t+e;i++){
//add new row if unavailable
u<i&&p(i);for(var s=n;s<n+r;s++){if(!1!==a[i][s])return v(t,n+1,e,r);o.push(i),o.push(s)}}return o},m=function(t){var n={},e,r,o=O(t).attr("data-pg-colspan");void 0===o&&(o=1);var i=O(t).attr("data-pg-rowspan");return void 0===i&&(i=1),o>c.columns&&(o=c.columns),e=2<=o?f*o+c.gutter*(o-1):f,r=2<=i?h*i+c.gutter*(i-1):h,n.element=t,n.rows=parseInt(i),n.cols=parseInt(o),n.size=[e,r],n.width=e,n.height=r,n},w=function(t,n){var e,r,o=n[0],i=n[1];e=i*(f+c.gutter),r=(h+c.gutter)*o,t.posX=[o,e],t.posY=[i,r];for(var s=o;s<o+t.rows;s++)for(var u=i;u<i+t.cols;u++)a[s][u]=t;return t.posY=r,t.posX=e,t},b=function(t){O(t.element).css({width:t.width,height:t.height,position:"absolute",opacity:1,top:t.posY,left:t.posX})},I=function(){},j=debounce(function(){i=0,a={};var e=O(P).width();c.columns=o,O.each(c.responsive,function(t,n){e>n[0]&&e<=n[1]&&(c.columns=n[2])}),y()},100);// Maximum run of once per 500 milliseconds
// Add the event listener
P.addEventListener("resize",j,!1);var y=function(){
//_fillGap();
if(c.beforeStart(),f=g(),p(0),O.each(e,function(t){var n=m(this),e;n.index=t,e=v(0,0,n.rows,n.cols),n=w(n,e),c.beforePlaceObject(n,e),b(n),c.afterPlaceObject(n,e)}),!1===c.containerHeight){var t=parseInt(u+1)*(h+c.gutter)-c.gutter;s.css({height:t})}else{h=l(),s.css({height:c.containerHeight});var t=parseInt(u+1)*(h+c.gutter)-c.gutter,n=s.height();n<t?h=n/parseInt(u+1)-c.gutter:s.css({height:t}),j()}c.afterEnd()};n._updateLayout=function(){i=0,a={},y()},n._init=function(){if(o=c.columns,e=s.children(c.selector),0===r.length)return!0;s.css({position:"relative"}),h=l(),j()},n._init()},O.fn.protongrid=function(n){return this.each(function(){if(e===O(this).data("protongrid")){var t=new O.protongrid(this,n);O(this).data("protongrid",t)}})}}(jQuery,window,document);